# 카드 뒤집기 테스트 (주의력 테스트) 알고리즘 문서

## 개요

카드 뒤집기 테스트는 아동의 **작업 기억(Working Memory)**과 **주의력(Attention)**을 측정하는 짝 맞추기(Memory Matching) 과제입니다.

- 3쌍(6장)의 카드를 뒤집어 짝을 맞추는 게임
- 적은 횟수로 완료할수록 기억력이 좋음
- 같은 카드를 여러 번 확인하면 재확인율이 높음

---

## 1. 입력 데이터

테스트 완료 후 수집되는 데이터:

| 필드 | 설명 | 예시 |
|------|------|------|
| `totalMoves` | 총 카드 뒤집기 횟수 | 14 |
| `totalTurns` | 총 턴 수 (카드 2장 = 1턴) | 7 |
| `revisitCount` | 재확인 횟수 (이미 본 카드 다시 뒤집기) | 2 |
| `hintUsedCount` | 힌트 사용 횟수 | 1 |
| `reactionTimesMs` | 개별 반응 시간 목록 (ms) | [2500, 3000, ...] |
| `durationSeconds` | 총 소요 시간 (초) | 45 |
| `ageMonths` | 아동 월령 | 48 |

---

## 2. 또래 규준값 (Peer Norms)

### MER (Memory Efficiency Ratio) 규준값

| 연령 | 월령 범위 | 평균(μ) | 표준편차(σ) |
|------|----------|---------|------------|
| 3세 전반 | 36~41개월 | 0.42 (42%) | 0.15 (15%) |
| 3세 후반 | 42~47개월 | 0.55 (55%) | 0.14 (14%) |
| 4세 전반 | 48~53개월 | 0.68 (68%) | 0.12 (12%) |
| 4세 후반~5세 | 54~60개월 | 0.78 (78%) | 0.10 (10%) |

### 재확인율 (Revisiting Rate) 규준값
> ⚠️ 재확인율은 **낮을수록 좋음** (Z점수 계산 시 방향 반전)

| 연령 | 월령 범위 | 평균(μ) | 표준편차(σ) |
|------|----------|---------|------------|
| 3세 전반 | 36~41개월 | 30% (0.30) | 10% (0.10) |
| 3세 후반 | 42~47개월 | 22% (0.22) | 8% (0.08) |
| 4세 전반 | 48~53개월 | 14% (0.14) | 6% (0.06) |
| 4세 후반~5세 | 54~60개월 | 8% (0.08) | 5% (0.05) |

### 반응시간 규준값 (초)

| 연령 | 월령 범위 | 최소값 | 최대값 | 중앙값 |
|------|----------|--------|--------|--------|
| 3세 전반 | 36~41개월 | 3.0초 | 4.5초 | 3.75초 |
| 3세 후반 | 42~47개월 | 2.5초 | 3.5초 | 3.0초 |
| 4세 전반 | 48~53개월 | 2.0초 | 3.0초 | 2.5초 |
| 4세 후반~5세 | 54~60개월 | 1.5초 | 2.5초 | 2.0초 |

---

## 3. 계산 알고리즘

### 3.1 MER (Memory Efficiency Ratio) 계산

**MER = 기준턴수 / 실제턴수**

- 기준턴수: 3 (완벽하게 기억하면 3턴에 완료 가능)
- 실제턴수: 실제로 플레이한 턴 수

```
MER = 3 / totalTurns
```

**힌트 페널티 적용:**
```
힌트 페널티 = hintUsedCount × 0.05
MER (최종) = MER - 힌트 페널티
```

**예시 계산** (48개월 아동, totalTurns=5, hintUsedCount=1):
```
MER (원본) = 3 / 5 = 0.60 (60%)
힌트 페널티 = 1 × 0.05 = 0.05
MER (최종) = 0.60 - 0.05 = 0.55 (55%)
```

### 3.2 재확인율 계산

**재확인율 = 재확인 횟수 / 총 이동 횟수**

```
재확인율 = revisitCount / totalMoves
```

**예시 계산** (revisitCount=3, totalMoves=12):
```
재확인율 = 3 / 12 = 0.25 (25%)
```

### 3.3 평균 반응시간 계산

**평균 반응시간 = 반응시간 합계 / 반응 횟수**

```
평균 반응시간 (초) = sum(reactionTimesMs) / length(reactionTimesMs) / 1000
```

대체 계산 (반응시간 데이터가 없을 때):
```
평균 반응시간 = durationSeconds / totalMoves
```

### 3.4 Z점수 계산

```
MER Z점수 = (MER - μ) / σ
재확인율 Z점수 = (μ - 재확인율) / σ  ← 방향 반전 (낮을수록 좋음)
```

**예시 계산** (48개월 아동, MER=0.55, 재확인율=0.25):
```
MER Z점수 = (0.55 - 0.68) / 0.12 = -1.08
재확인율 Z점수 = (0.14 - 0.25) / 0.06 = -1.83
```

---

## 4. 행동유형 분류 (6가지 패턴)

### 분류 기준

| 조건 | MER Z ≥ 0 (기억력 좋음) | MER Z < 0 (기억력 발달 중) |
|------|------------------------|--------------------------|
| **재확인율 Z ≥ 0** + **RT 느림** | 신중한 탐험가 (carefulExplorer) | 끈기있는 도전자 (diligentTrier) |
| **재확인율 Z ≥ 0** + **RT 빠름** | 빠른 처리자 (quickProcessor) | 활발한 탐험가 (energeticExplorer) |
| **재확인율 Z < 0** (재확인 많음) | 확인형 기억 우수형 (confirmingMemory) | 직관적 추측형 (intuitiveGuesser) |

### 분류 알고리즘

```dart
// MER이 평균 이상인지
bool isHighMer = merZ >= 0;

// 재확인율이 평균 이하인지 (Z점수 방향 반전됨)
bool isLowRevisit = revisitZ >= 0;

// 반응시간이 느린지
bool isSlowReaction = avgReactionTime > rtNorm.midValue;

if (isHighMer && isLowRevisit) {
    // MER 높음 + 재확인율 낮음
    if (isSlowReaction) {
        return "신중한 탐험가";
    } else {
        return "빠른 처리자";
    }
} else if (isHighMer && !isLowRevisit) {
    // MER 높음 + 재확인율 높음
    return "확인형 기억 우수형";
} else if (!isHighMer && isLowRevisit) {
    // MER 낮음 + 재확인율 낮음
    return "직관적 추측형";
} else {
    // MER 낮음 + 재확인율 높음
    if (isSlowReaction) {
        return "끈기있는 도전자";
    } else {
        return "활발한 탐험가";
    }
}
```

---

## 5. 결과 해석 UI 라벨

### 5.1 MER (기억 효율성) 라벨

| Z점수 범위 | 라벨 | 설명 |
|-----------|------|------|
| z > +1 | "기억력이 뛰어나요" | 또래보다 적은 횟수로 카드 짝을 맞췄어요! |
| -1 ≤ z ≤ +1 | "또래 평균" | 또래와 비슷한 기억력을 보여주고 있어요. |
| z < -1 | "기억력이 자라고 있어요" | 아직 카드 위치를 기억하는 게 어려울 수 있어요. |

### 5.2 재확인율 라벨

| Z점수 범위 | 라벨 | 설명 |
|-----------|------|------|
| z > +1 | "안정적인 기억력" | 한번 본 카드를 잘 기억해요! |
| -1 ≤ z ≤ +1 | "또래 평균" | 또래와 비슷한 수준이에요. |
| z < -1 | "활발한 탐색" | 확인하고 싶은 마음이 많아요. |

### 5.3 반응시간 라벨

| 조건 | 라벨 | 설명 |
|------|------|------|
| RT ≤ midValue | "빠른 반응" | 빠르게 결정하는 편이에요. |
| RT > midValue | "신중한 반응" | 생각하고 결정하는 편이에요. |

---

## 6. 결과 화면 구성

### 6.1 행동유형 카드

표시 내용:
- 행동유형 라벨 (예: "신중한 탐험가")
- 설명 텍스트

### 6.2 결과 해석 카드 (3가지 지표)

1. **기억 효율성 (MER)**
   - 제목: "기억 효율성 X% (또래 평균 Y%)"
   - 설명: Z점수에 따른 해석

2. **재확인율**
   - 제목: "재확인율 X% (또래 평균 Y%)"
   - 설명: Z점수에 따른 해석

3. **반응시간**
   - 제목: "평균 반응 시간 X초"
   - 설명: 빠름/느림에 따른 해석

### 6.3 또래 평균 범위 차트

- 가로 막대 차트
- 회색 띠: 또래 평균 범위 (-1σ ~ +1σ)
- 파란 점: 내 아이 위치
- 하단 라벨: "내 아이 X% · 또래 평균 Y%"

### 6.4 양육 팁

행동유형별 맞춤 팁 2개 제공

---

## 7. 예시 시나리오

### 시나리오 1: 48개월 아동, 기억력 좋은 신중한 아이

**입력:**
- 월령: 48개월
- totalMoves: 8
- totalTurns: 4
- revisitCount: 1
- hintUsedCount: 0
- avgReactionTime: 2.8초

**계산:**
```
MER = 3 / 4 = 0.75 (75%)
재확인율 = 1 / 8 = 0.125 (12.5%)

MER Z점수 = (0.75 - 0.68) / 0.12 = +0.58
재확인율 Z점수 = (0.14 - 0.125) / 0.06 = +0.25

반응시간: 2.8초 > 2.5초 (중앙값) → 느림
```

**분류:**
- MER Z ≥ 0 ✅ (기억력 좋음)
- 재확인율 Z ≥ 0 ✅ (재확인 적음)
- 반응시간 느림 ✅

**결과:**
- 행동유형: **"신중한 탐험가"**
- MER: 75% (또래 평균 68%) - "또래 평균"
- 재확인율: 12.5% (또래 평균 14%) - "또래 평균"
- 반응시간: 2.8초 - "신중한 반응"

---

### 시나리오 2: 42개월 아동, 빠르고 정확한 아이

**입력:**
- 월령: 42개월
- totalMoves: 8
- totalTurns: 4
- revisitCount: 1
- hintUsedCount: 0
- avgReactionTime: 2.5초

**계산:**
```
MER = 3 / 4 = 0.75 (75%)
재확인율 = 1 / 8 = 0.125 (12.5%)

MER Z점수 = (0.75 - 0.55) / 0.14 = +1.43
재확인율 Z점수 = (0.22 - 0.125) / 0.08 = +1.19

반응시간: 2.5초 < 3.0초 (중앙값) → 빠름
```

**분류:**
- MER Z ≥ 0 ✅
- 재확인율 Z ≥ 0 ✅
- 반응시간 빠름 ✅

**결과:**
- 행동유형: **"빠른 처리자"**
- MER: 75% (또래 평균 55%) - "기억력이 뛰어나요"
- 재확인율: 12.5% (또래 평균 22%) - "안정적인 기억력"
- 반응시간: 2.5초 - "빠른 반응"

---

### 시나리오 3: 48개월 아동, 확인을 많이 하지만 정확한 아이

**입력:**
- 월령: 48개월
- totalMoves: 12
- totalTurns: 4
- revisitCount: 4
- hintUsedCount: 0
- avgReactionTime: 2.3초

**계산:**
```
MER = 3 / 4 = 0.75 (75%)
재확인율 = 4 / 12 = 0.333 (33.3%)

MER Z점수 = (0.75 - 0.68) / 0.12 = +0.58
재확인율 Z점수 = (0.14 - 0.333) / 0.06 = -3.22

반응시간: 2.3초 < 2.5초 (중앙값) → 빠름
```

**분류:**
- MER Z ≥ 0 ✅
- 재확인율 Z < 0 (재확인 많음)

**결과:**
- 행동유형: **"확인형 기억 우수형"**
- MER: 75% (또래 평균 68%) - "또래 평균"
- 재확인율: 33% (또래 평균 14%) - "활발한 탐색"
- 반응시간: 2.3초 - "빠른 반응"

---

### 시나리오 4: 48개월 아동, 직관적으로 플레이하는 아이

**입력:**
- 월령: 48개월
- totalMoves: 10
- totalTurns: 6
- revisitCount: 1
- hintUsedCount: 0
- avgReactionTime: 2.0초

**계산:**
```
MER = 3 / 6 = 0.50 (50%)
재확인율 = 1 / 10 = 0.10 (10%)

MER Z점수 = (0.50 - 0.68) / 0.12 = -1.50
재확인율 Z점수 = (0.14 - 0.10) / 0.06 = +0.67

반응시간: 2.0초 < 2.5초 (중앙값) → 빠름
```

**분류:**
- MER Z < 0 (기억력 발달 중)
- 재확인율 Z ≥ 0 ✅ (재확인 적음)

**결과:**
- 행동유형: **"직관적 추측형"**
- MER: 50% (또래 평균 68%) - "기억력이 자라고 있어요"
- 재확인율: 10% (또래 평균 14%) - "또래 평균"
- 반응시간: 2.0초 - "빠른 반응"

---

### 시나리오 5: 42개월 아동, 끈기있게 노력하는 아이

**입력:**
- 월령: 42개월
- totalMoves: 16
- totalTurns: 7
- revisitCount: 5
- hintUsedCount: 1
- avgReactionTime: 3.5초

**계산:**
```
MER (원본) = 3 / 7 = 0.429 (42.9%)
힌트 페널티 = 1 × 0.05 = 0.05
MER (최종) = 0.429 - 0.05 = 0.379 (37.9%)

재확인율 = 5 / 16 = 0.3125 (31.25%)

MER Z점수 = (0.379 - 0.55) / 0.14 = -1.22
재확인율 Z점수 = (0.22 - 0.3125) / 0.08 = -1.16

반응시간: 3.5초 > 3.0초 (중앙값) → 느림
```

**분류:**
- MER Z < 0 (기억력 발달 중)
- 재확인율 Z < 0 (재확인 많음)
- 반응시간 느림 ✅

**결과:**
- 행동유형: **"끈기있는 도전자"**
- MER: 38% (또래 평균 55%) - "기억력이 자라고 있어요"
- 재확인율: 31% (또래 평균 22%) - "활발한 탐색"
- 반응시간: 3.5초 - "신중한 반응"

---

### 시나리오 6: 42개월 아동, 활발하게 탐색하는 아이

**입력:**
- 월령: 42개월
- totalMoves: 14
- totalTurns: 6
- revisitCount: 4
- hintUsedCount: 0
- avgReactionTime: 2.2초

**계산:**
```
MER = 3 / 6 = 0.50 (50%)
재확인율 = 4 / 14 = 0.286 (28.6%)

MER Z점수 = (0.50 - 0.55) / 0.14 = -0.36
재확인율 Z점수 = (0.22 - 0.286) / 0.08 = -0.82

반응시간: 2.2초 < 3.0초 (중앙값) → 빠름
```

**분류:**
- MER Z < 0 (기억력 발달 중)
- 재확인율 Z < 0 (재확인 많음)
- 반응시간 빠름 ✅

**결과:**
- 행동유형: **"활발한 탐험가"**
- MER: 50% (또래 평균 55%) - "또래 평균"
- 재확인율: 29% (또래 평균 22%) - "또래 평균"
- 반응시간: 2.2초 - "빠른 반응"

---

## 8. 행동유형별 상세 설명 및 양육 팁

### 8.1 신중한 탐험가 (carefulExplorer)

**조건:** MER Z ≥ 0 + 재확인율 Z ≥ 0 + RT 느림

**설명:**
> 천천히 생각하며 카드 위치를 잘 기억해요. 한번 본 것을 꼼꼼히 기억하고, 확실할 때 결정하는 편이에요.

**양육 팁:**
1. 충분한 시간을 주고 기다려주세요.
2. 신중한 성격을 칭찬해주세요.

---

### 8.2 빠른 처리자 (quickProcessor)

**조건:** MER Z ≥ 0 + 재확인율 Z ≥ 0 + RT 빠름

**설명:**
> 빠르게 카드 위치를 파악하고 기억해요. 효율적으로 과제를 수행하는 편이에요.

**양육 팁:**
1. 빠른 처리 능력을 활용한 게임을 즐겨보세요.
2. 때로는 천천히 생각하는 연습도 해보세요.

---

### 8.3 확인형 기억 우수형 (confirmingMemory)

**조건:** MER Z ≥ 0 + 재확인율 Z < 0

**설명:**
> 기억력은 좋지만, 확실하게 확인하고 싶어하는 편이에요. 신중하게 확인하는 것은 좋은 습관이에요.

**양육 팁:**
1. 확인하는 습관을 인정해주세요.
2. 자신감을 키워줄 수 있는 활동을 해보세요.

---

### 8.4 직관적 추측형 (intuitiveGuesser)

**조건:** MER Z < 0 + 재확인율 Z ≥ 0

**설명:**
> 직감적으로 빠르게 결정하는 편이에요. 확인보다는 추측을 선호해요.

**양육 팁:**
1. 기억력 게임을 짧게 자주 해보세요.
2. "다시 한번 볼까?" 하고 확인하는 연습을 해보세요.

---

### 8.5 끈기있는 도전자 (diligentTrier)

**조건:** MER Z < 0 + 재확인율 Z < 0 + RT 느림

**설명:**
> 아직 기억하기가 어렵지만, 포기하지 않고 열심히 노력해요. 시간이 지나면 점점 나아질 거예요.

**양육 팁:**
1. 노력하는 모습을 칭찬해주세요.
2. 카드 수를 줄여서 성공 경험을 쌓아보세요.

---

### 8.6 활발한 탐험가 (energeticExplorer)

**조건:** MER Z < 0 + 재확인율 Z < 0 + RT 빠름

**설명:**
> 빠르게 여러 카드를 탐색하며 놀아요. 호기심이 많고 활발한 편이에요.

**양육 팁:**
1. 활발한 에너지를 인정해주세요.
2. 짧은 집중 시간으로 자주 연습해보세요.

---

## 9. 참고문헌

- Oeri N, et al. (2019) Front. Psychol. - 작업기억 발달 연구
- 카드 뒤집기 과제 기반 주의력 평가 연구

