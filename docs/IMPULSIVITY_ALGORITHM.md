# 풍선 테스트 (충동성 테스트) 알고리즘 문서

## 개요

풍선 테스트는 아동의 충동성(억제 능력)과 주의력(부주의)을 측정하는 Go/No-Go 과제입니다.

- **파란 풍선 (Go)**: 터치해야 함 → 놓치면 부주의(Omission Error)
- **빨간 풍선 (No-Go)**: 터치하면 안 됨 → 터치하면 충동성(Commission Error)

---

## 1. 입력 데이터

테스트 완료 후 수집되는 데이터:

| 필드 | 설명 | 예시 |
|------|------|------|
| `totalStimuli` | 총 자극 수 | 40 |
| `commissionErrors` | 빨간 풍선 터치 횟수 (충동성) | 3 |
| `omissionErrors` | 파란 풍선 놓친 횟수 (부주의) | 2 |
| `reactionTimeAverage` | 평균 반응 시간 (ms) | 850 |
| `ageMonths` | 아동 월령 | 45 |

---

## 2. 또래 규준값 (Peer Norms)

### 억제 비율 규준값 (Wiebe SA, 2012)

| 연령 | 월령 범위 | 평균(μ) | 표준편차(σ) |
|------|----------|---------|------------|
| 3세 | 36~47개월 | 74% (0.74) | 31.2% (0.312) |
| 4세 | 48~59개월 | 84% (0.84) | 20.6% (0.206) |
| 5세 | 60~72개월 | 89% (0.89) | 13.7% (0.137) |

### 부주의 비율 규준값

| 연령 | 월령 범위 | 평균(μ) | 표준편차(σ) |
|------|----------|---------|------------|
| 3세 | 36~47개월 | 18% (0.18) | 12% (0.12) |
| 4세 | 48~59개월 | 12% (0.12) | 8% (0.08) |
| 5세 | 60~72개월 | 8% (0.08) | 5% (0.05) |

### 반응시간 규준값 (ms)

| 연령 | 월령 범위 | 평균(μ) | 표준편차(σ) |
|------|----------|---------|------------|
| 3세 | 36~47개월 | 934ms | 200ms |
| 4세 | 48~59개월 | 835ms | 180ms |
| 5세 | 60~72개월 | 733ms | 150ms |

---

## 3. 계산 알고리즘

### 3.1 기본 계산

```
No-Go 자극 수 = totalStimuli × 0.25 (25%)
Go 자극 수 = totalStimuli - No-Go 자극 수

억제 비율 = (No-Go 자극 수 - commissionErrors) / No-Go 자극 수
부주의 비율 = omissionErrors / Go 자극 수
```

**예시 계산** (45개월 아동, totalStimuli=40, commissionErrors=3, omissionErrors=2):
```
No-Go 자극 수 = 40 × 0.25 = 10
Go 자극 수 = 40 - 10 = 30

억제 비율 = (10 - 3) / 10 = 0.70 (70%)
부주의 비율 = 2 / 30 = 0.067 (6.7%)
```

### 3.2 Z점수 계산

```
Z점수 = (관측값 - 평균) / 표준편차

억제 비율 Z점수 = (억제 비율 - μ) / σ
부주의 비율 Z점수 = (μ - 부주의 비율) / σ  ← 방향 반전 (낮을수록 좋음)
```

**예시 계산** (45개월 아동):
```
억제 비율 Z점수 = (0.70 - 0.74) / 0.312 = -0.128
부주의 비율 Z점수 = (0.18 - 0.067) / 0.12 = +0.942
```

### 3.3 반응속도 판단

```
반응속도 = "빠름" if reactionTimeAverage < μ(반응시간) else "느림"
```

**예시** (45개월 아동, RT=850ms):
```
850ms < 934ms → 반응속도 = "빠름"
```

---

## 4. 행동유형 분류 (4분면)

```
┌─────────────────────────────────────────────────────────────┐
│                    억제 비율 Z점수 ≥ 0                        │
│                    (참을성이 좋음)                            │
├─────────────────────────┬───────────────────────────────────┤
│   빠르게 반응하지만       │       차분하고 안정적인 아이        │
│   멈출 줄 아는 아이        │                                   │
│   (quickAndControlled)   │     (calmAndStable)              │
│                         │                                   │
│   RT < 평균              │      RT ≥ 평균                    │
├─────────────────────────┼───────────────────────────────────┤
│   에너지가 먼저           │    천천히 익혀가는 단계의 아이       │
│   나오는 아이             │                                   │
│   (energyFirst)          │    (learningAtOwnPace)           │
│                         │                                   │
│   RT < 평균              │      RT ≥ 평균                    │
├─────────────────────────┴───────────────────────────────────┤
│                    억제 비율 Z점수 < 0                        │
│                    (에너지가 많음)                            │
└─────────────────────────────────────────────────────────────┘
```

### 분류 알고리즘

```dart
if (isFastReactor) {  // RT < 또래 평균
    if (inhibitionZ >= 0) {
        return "빠르게 반응하지만 멈출 줄 아는 아이"
    } else {
        return "에너지가 먼저 나오는 아이"
    }
} else {  // RT >= 또래 평균
    if (inhibitionZ >= 0) {
        return "차분하고 안정적인 아이"
    } else {
        return "천천히 익혀가는 단계의 아이"
    }
}
```

---

## 5. 결과 해석 UI 라벨

### 5.1 억제 비율 (충동성) 라벨

| Z점수 범위 | 라벨 | 설명 |
|-----------|------|------|
| z > +1 | "참을성이 좋음" | 빨간 풍선을 잘 참았어요! 충동을 조절하는 능력이 또래보다 잘 발달되어 있어요. |
| -1 ≤ z ≤ +1 | "또래 평균" | 빨간 풍선을 참는 것이 또래와 비슷한 수준이에요. |
| z < -1 | "에너지가 많음" | 빨간 풍선을 참기 어려웠어요. 이 나이에는 자연스러운 반응이에요. |

### 5.2 부주의 비율 라벨

| Z점수 범위 | 라벨 | 설명 |
|-----------|------|------|
| z > +1 | "집중력이 좋아요" | 파란 풍선을 잘 눌렀어요! 집중력이 또래보다 잘 발달되어 있어요. |
| -1 ≤ z ≤ +1 | "또래 평균" | 파란 풍선에 반응하는 것이 또래와 비슷한 수준이에요. |
| z < -1 | "주의 집중 연습이 필요해요" | 파란 풍선을 놓치는 경우가 있었어요. |

### 5.3 반응시간 라벨

| 조건 | 라벨 | 설명 |
|------|------|------|
| RT < 또래평균 | "빠른 편" | 반응이 빠른 편이에요. 빠른 반응은 좋지만, 때로는 신중함도 필요해요. |
| RT ≥ 또래평균 | "신중한 편" | 신중하게 생각하고 반응하는 편이에요. |

---

## 6. 결과 화면 구성

### 6.1 행동유형 카드

표시 내용:
- 행동유형 라벨 (예: "빠르게 반응하지만 멈출 줄 아는 아이")
- 설명 텍스트

### 6.2 결과 해석 카드 (3가지 지표)

1. **충동성** (억제 비율)
   - 제목: "충동성 X% (또래 평균 Y%)"
   - 설명: Z점수에 따른 해석
   
2. **부주의** (omission 비율)
   - 제목: "부주의 X% (또래 평균 Y%)"
   - 설명: Z점수에 따른 해석
   
3. **반응시간**
   - 제목: "평균 반응 시간 Xms"
   - 설명: 빠름/느림에 따른 해석

### 6.3 또래 평균 범위 차트

- 가로 막대 차트
- 회색 띠: 또래 평균 범위 (-1σ ~ +1σ)
- 파란 점: 내 아이 위치
- 하단 라벨: "내 아이 X% · 또래 평균 Y%"

### 6.4 양육 팁

행동유형별 맞춤 팁 2개 제공

---

## 7. 예시 시나리오

### 시나리오 1: 45개월 아동, 잘 참는 아이

**입력:**
- 월령: 45개월
- totalStimuli: 40
- commissionErrors: 1
- omissionErrors: 1
- reactionTimeAverage: 800ms

**계산:**
```
No-Go 자극 수 = 10
Go 자극 수 = 30

억제 비율 = (10 - 1) / 10 = 0.90 (90%)
부주의 비율 = 1 / 30 = 0.033 (3.3%)

억제 비율 Z점수 = (0.90 - 0.74) / 0.312 = +0.51
부주의 비율 Z점수 = (0.18 - 0.033) / 0.12 = +1.22

반응속도: 800ms < 934ms → 빠름
```

**결과:**
- 행동유형: **"빠르게 반응하지만 멈출 줄 아는 아이"**
- 충동성: 90% (또래 평균 74%) - "또래 평균"
- 부주의: 3% (또래 평균 18%) - "집중력이 좋아요"
- 반응시간: 800ms - "빠른 편"

---

### 시나리오 2: 45개월 아동, 에너지가 많은 아이

**입력:**
- 월령: 45개월
- totalStimuli: 40
- commissionErrors: 5
- omissionErrors: 3
- reactionTimeAverage: 700ms

**계산:**
```
억제 비율 = (10 - 5) / 10 = 0.50 (50%)
부주의 비율 = 3 / 30 = 0.10 (10%)

억제 비율 Z점수 = (0.50 - 0.74) / 0.312 = -0.77
부주의 비율 Z점수 = (0.18 - 0.10) / 0.12 = +0.67

반응속도: 700ms < 934ms → 빠름
```

**결과:**
- 행동유형: **"에너지가 먼저 나오는 아이"**
- 충동성: 50% (또래 평균 74%) - "또래 평균"
- 부주의: 10% (또래 평균 18%) - "또래 평균"
- 반응시간: 700ms - "빠른 편"

---

### 시나리오 3: 54개월 아동, 차분한 아이

**입력:**
- 월령: 54개월
- totalStimuli: 40
- commissionErrors: 2
- omissionErrors: 2
- reactionTimeAverage: 900ms

**계산:**
```
억제 비율 = (10 - 2) / 10 = 0.80 (80%)
부주의 비율 = 2 / 30 = 0.067 (6.7%)

억제 비율 Z점수 = (0.80 - 0.84) / 0.206 = -0.19
부주의 비율 Z점수 = (0.12 - 0.067) / 0.08 = +0.66

반응속도: 900ms > 835ms → 느림
```

**결과:**
- 행동유형: **"차분하고 안정적인 아이"**
- 충동성: 80% (또래 평균 84%) - "또래 평균"
- 부주의: 7% (또래 평균 12%) - "또래 평균"
- 반응시간: 900ms - "신중한 편"

---

### 시나리오 4: 45개월 아동, 발달 중인 아이

**입력:**
- 월령: 45개월
- totalStimuli: 40
- commissionErrors: 6
- omissionErrors: 5
- reactionTimeAverage: 1000ms

**계산:**
```
억제 비율 = (10 - 6) / 10 = 0.40 (40%)
부주의 비율 = 5 / 30 = 0.167 (16.7%)

억제 비율 Z점수 = (0.40 - 0.74) / 0.312 = -1.09
부주의 비율 Z점수 = (0.18 - 0.167) / 0.12 = +0.11

반응속도: 1000ms > 934ms → 느림
```

**결과:**
- 행동유형: **"천천히 익혀가는 단계의 아이"**
- 충동성: 40% (또래 평균 74%) - "에너지가 많음"
- 부주의: 17% (또래 평균 18%) - "또래 평균"
- 반응시간: 1000ms - "신중한 편"

---

## 8. 행동유형별 상세 설명 및 양육 팁

### 8.1 빠르게 반응하지만 멈출 줄 아는 아이 (quickAndControlled)

**조건:** RT 빠름 + 억제 비율 Z점수 ≥ 0

**설명:**
> 새로운 자극을 빠르게 포착해서 재빨리 반응할 수 있으면서도, 멈추라는 신호를 보면 잘 멈출 수 있어요.

**양육 팁:**
1. 팀 놀이나 운동에서 '선두이자 안전요원' 역할을 맡겨보세요.
2. 신호에 따라 행동하는 게임을 더 즐겨보세요.

---

### 8.2 에너지가 먼저 나오는 아이 (energyFirst)

**조건:** RT 빠름 + 억제 비율 Z점수 < 0

**설명:**
> 재미있어 보이는 것은 일단 먼저 눌러 보고 싶은 마음이 큰 편이에요. 짧은 게임처럼 '멈추기 신호'를 연습하면 좋아요.

**양육 팁:**
1. '그대로 멈춰라' 같은 브레이크 연습 놀이를 해보세요.
2. 짧은 게임으로 '멈추기 신호' 연습을 반복해보세요.

---

### 8.3 차분하고 안정적인 아이 (calmAndStable)

**조건:** RT 느림 + 억제 비율 Z점수 ≥ 0

**설명:**
> 서두르기보다 한 번 더 보고, 생각한 뒤에 움직이는 편이에요. 규칙을 지키는 활동에서 강점을 보일 수 있어요.

**양육 팁:**
1. 차분한 성격을 활용한 집중 활동을 시도해보세요.
2. 새로운 도전 앞에서 작은 단계부터 속도를 올려보세요.

---

### 8.4 천천히 익혀가는 단계의 아이 (learningAtOwnPace)

**조건:** RT 느림 + 억제 비율 Z점수 < 0

**설명:**
> 새로운 과제에서는 속도도 아직 느리고, 멈추기 규칙도 이제 막 익혀 가는 중이에요. 충분한 시간과 반복 기회를 주면 좋아요.

**양육 팁:**
1. 같은 규칙을 여러 번, 짧게 나누어 연습해주세요.
2. 충분한 시간을 주고 아이의 속도에 맞춰주세요.

---

## 9. 참고문헌

- Abdul Rahman A, et al. (2017) Dev Neuropsychol.
- Oeri N, et al. (2019) Front. Psychol.
- Wiebe SA, et al. (2012) Child Dev.

